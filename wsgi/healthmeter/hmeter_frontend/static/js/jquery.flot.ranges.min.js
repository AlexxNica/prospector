(function(e){var b=Number.MAX_VALUE;function f(i){i=+i;if(i==Infinity){return b}else{if(i==-Infinity){return -b}else{return i}}}function c(r,k,n,q){if(!k.ranges.show){return}var u=[];q.pointsize=4;q.points=[];q.format=[{x:true,number:true,required:true},{y:true,number:true,required:true},{x:true,number:true,required:true},{y:true,number:true,required:true}];for(var m=0;m<n.length;m++){var j=n[m][0];var l=n[m][1];var s=f(j[0]);var t=f(j[1]);var p=f(l[0]);var o=f(l[1]);q.points.push(s,t,p,o)}}function h(n,r,j){if(!j.ranges.show){return}var o=n.getPlotOffset();var k=e.color.parse(j.color);var q={xaxis:j.xaxis,yaxis:j.yaxis};r.save();r.beginPath();r.rect(o.left,o.top,n.width(),n.height());r.closePath();r.clip();r.strokeStyle=k.toString();r.lineWidth=j.lineWidth;r.lineJoin="round";if(j.ranges.fill){r.fillStyle=k.scale("a",j.ranges.opacity).toString()}else{r.fillStyle="none"}var p=j.datapoints.points;for(var l=0;l<p.length;l+=j.datapoints.pointsize){var m={from:{x:p[l],y:p[l+1]},to:{x:p[l+2],y:p[l+3]},axes:q};a(n,r,m)}r.restore()}function a(m,u,l){var s=e.extend({},l.from,l.axes);var r=e.extend({},l.to,l.axes);var n=m.getPlotOffset();e.extend(s,m.pointOffset(s));e.extend(r,m.pointOffset(r));var t=[s,r];for(var j=0;j<t.length;j++){if(t[j].x==b){t[j].left=n.left}else{if(t[j].x==-b){t[j].left=n.left+m.width()}}if(t[j].y==b){t[j].top=n.top}else{if(t[j].y==-b){t[j].top=n.top+m.height()}}}var p=Math.min(s.left,r.left);var o=Math.min(s.top,r.top);var q=Math.abs(s.left-r.left);var k=Math.abs(s.top-r.top);if(q==0||k==0){u.beginPath();u.moveTo(p,o);u.lineTo(p+q,o+k);u.closePath();u.stroke()}else{u.fillRect(p,o,q,k);u.strokeRect(p,o,q,k)}}function d(v,m,w,s){var l=Math.min(m[0],m[2]);var r=Math.min(m[1],m[3]);var x=Math.max(m[0],m[2]);var t=Math.max(m[1],m[3]);var p=w.p2c(v.x);var q=w.p2c(v.y);var u=w.p2c(l);var n=w.p2c(x);var o=w.p2c(t);var i=w.p2c(r);var k=Math.min(Math.abs(p-u),Math.abs(p-n));var j=Math.min(Math.abs(q-i),Math.abs(q-o));if(l<=v.x&&v.x<=x){if(r<=v.y&&v.y<=t){return 0}else{return j}}else{if(r<=v.y&&v.y<=t){return k}else{return Math.sqrt(k*k+j*j)}}}function g(i){i.hooks.processRawData.push(c);i.hooks.drawSeries.push(h);i.findRanges=function(x){var p=i.getData();var t=[];for(var r=0;r<p.length;r++){var o=p[r];if(!o.ranges.show){continue}var u=o.datapoints;var k=b;var n=null;for(var q=0;q<u.points.length;q+=u.pointsize){var s=[u.points[q],u.points[q+1],u.points[q+2],u.points[q+3]];var m=i.getOptions().grid.mouseActiveRadius;var w=o.xaxis;var v=o.yaxis;var l=d(x,s,w,v);if(l<k&&l<=m){k=l;n={datapoint:s,dataIndex:q/u.pointsize,series:o,seriesIndex:r}}}if(n!=null){t.push(n)}}return t}}e.plot.plugins.push({init:g,options:{series:{ranges:{show:false,fill:true,opacity:0.4,lineWidth:2,}}},name:"ranges",version:"0.1"})})(jQuery);