(function(b){var a={series:{stack:null}};function c(f){function d(k,j){var h=null;for(var g=0;g<j.length;++g){if(k==j[g]){break}if(j[g].stack==k.stack){h=j[g]}}return h}function e(D,w,g){if(w.stack==null||w.stack===false){return}var n=d(w,D.getData());if(!n){return}var A=g.pointsize,G=g.points,u=n.datapoints.pointsize,K=n.datapoints.points,q=[],x,v,r,J,I,k,t=w.lines.show,H=w.bars.horizontal,p=A>2&&(H?g.format[2].x:g.format[2].y),h=t&&w.lines.steps,F=true,o=H?1:0,y=H?0:1,E=0,C=0,B,z;while(true){if(E>=G.length){break}B=q.length;if(G[E]==null){for(z=0;z<A;++z){q.push(G[E+z])}E+=A}else{if(C>=K.length){for(z=0;z<A;++z){q.push(G[E+z])}E+=A}else{if(K[C]==null){for(z=0;z<A;++z){q.push(null)}F=true;C+=u}else{x=G[E+o];v=G[E+y];J=K[C+o];I=K[C+y];k=0;if(x==J){for(z=0;z<A;++z){q.push(G[E+z])}q[B+y]+=I;k=I;E+=A;C+=u}else{if(x>J){if(t&&E>0&&G[E-A]!=null){r=v+(G[E-A+y]-v)*(J-x)/(G[E-A+o]-x);q.push(J);q.push(r+I);for(z=2;z<A;++z){q.push(G[E+z])}k=I}C+=u}else{for(z=0;z<A;++z){q.push(G[E+z])}if(t&&C>0&&K[C-u]!=null){k=I+(K[C-u+y]-I)*(x-J)/(K[C-u+o]-J)}q[B+y]+=k;E+=A}}F=false;if(B!=q.length&&p){q[B+2]+=k}}}}if(h&&B!=q.length&&B>0&&q[B]!=null&&q[B]!=q[B-A]&&q[B+1]!=q[B-A+1]){for(z=0;z<A;++z){q[B+A+z]=q[B+z]}q[B+1]=q[B-A+1]}}g.points=q}f.hooks.processDatapoints.push(e)}b.plot.plugins.push({init:c,options:a,name:"stack",version:"1.2"})})(jQuery);